<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title></title>

  <link href="css/jsoneditor.css" rel="stylesheet" type="text/css">
  <script src="js/jsoneditor.min.js"></script>
  <script src="js/paper-full.js"></script>

  <style type="text/css">
    #jsoneditor {
      width: 400px;
      height: 500px;
    }
  </style>
</head>
<body>
<div id="container">
  <p>
    <button id="run">Run</button>
    <button id="clear">clearStream</button>
  </p>
  <div id="jsoneditor" style="float: left"></div>
  <div id="canvas-container" style="border:solid;float:left;">
    <canvas id="myCanvas" style="border:2px; width:500px; height:500px;"></canvas>
  </div>
</div>
  

<script type="text/javascript" src="../js/weber.js"></script>
<script>
  var flashOrange = [
  {
    type: "update",
    method: "set",
    options: {
      strokeColor: 'orange',
      strokeWidth: 5
    },
    time: 0
    
  },
  {
    type: "update",
    method: "set",
    options: {
      strokeColor: 'black',
      strokeWidth: 1
    },
    time: 1000
  }];

  var demoStream = [
    {
      type: "add",
      item: "Path.Circle",
      options: {
        center: [300, 200],
        radius: 50,
        strokeColor: 'black',
        fillColor: 'white',
        name: 'aCircle'
      },
      time: 2000
    },
    {
      type: "updateOn",
      name: "aCircle",
      event: "click",
      time: 2000,
      options: flashOrange

    },
    {
      type: "add",
      item: "Path.Star",
      options: {
        center: [150, 250],
        points: 3,
        radius1: 50,
        radius2: 50,
        strokeColor: 'red',
        fillColor: 'white',
        name: 'aStar'
      },
      time: 2500,
      events:{
        'mouseenter': [{
            type: 'update',
            method: 'set',
            time: 0,
            options: { strokeColor: 'green'}
          },
          {
            type: 'log',
            name: 'aStar',
            props: ['position.x', 'position.y', '#time'],
            time: 0
          },
          {
            type: 'logMethod',
            method: 'nextEntry',
            time: 0
          }
        ],
        'mouseleave': [{
            type: 'update',
            method: 'set',
            time: 0,
            options: { strokeColor: 'red'}
        }]
      }
    },
    {
      type: "add",
      item: "Path.Rectangle",
      options: {
        from: [310, 340],
        to: [420, 440],
        strokeColor: 'blue',
        fillColor: 'white'
      },
      events: {
        doubleclick: flashOrange
      },
      time: 3000
    },
    {
      type: "removeAll",
      time: 4500
    }  
  ]

  var container = document.getElementById('jsoneditor')
  var editor = new JSONEditor(container); 
  editor.set(demoStream)

  var recorder = new Recorder('myCanvas');

  document.getElementById('run').onclick = function(){
    console.log('running')
    recorder.addStream(editor.get())
  }

  document.getElementById('clear').onclick = function(){
    console.log('clearStream')
    recorder.clearStream()
  }

  paper.view.onFrame = function(event){
    recorder.runStream(performance.now())
  }
</script>
</body>
</html>
