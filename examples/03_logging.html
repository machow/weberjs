<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title></title>

  <link href="css/jsoneditor.css" rel="stylesheet" type="text/css">
  <script src="js/jsoneditor.min.js"></script>
  <script src="js/paper-full.js"></script>

  <style type="text/css">
    #jsoneditor {
      width: 400px;
      height: 500px;
    }
  </style>
</head>
<body>
<div id="container">
  <p>
    <button id="run">Run</button>
    <button id="clear">clearStream</button>
  </p>
  <div id="jsoneditor" style="float: left"></div>
  <div id="canvas-container" style="border:solid;float:left;">
    <canvas id="myCanvas" style="border:2px; width:500px; height:500px;"></canvas>
  </div>
</div>
  

<script type="text/javascript" src="../js/weber.js"></script>
<script>
  var demoStream = [
   {
     type: "removeAll",
   },
   {
      type: "add",
      item: "PointText",
      options: {
        point: [250, 250],
        justification: 'center',
        content: 'demo stimuli',
        strokeColor: 'black',
        name: "instructionsText"
      },
      log: {textContent: 'content'},
      time: 500
    },
    {
      type: "add",
      item: "Path.Circle",
      options: {
        center: [300, 200],
        radius: 50,
        strokeColor: 'black',
        fillColor: 'white',
        name: 'aCircle'
      },
      log: ['area', 'length'],
      time: 2000,
      events: {
        'doubleclick': [{
            type: 'update',
            method: 'set',
            time: 0,
            options: { strokeColor: 'green'}
          },
          {
            type: 'log',
            name: 'aCircle',
            props: ['strokeColor.components', '#time'],
            time: 0
          },
          {
            type: 'logMethod',
            method: 'nextEntry',
            time: 0
          }
        ]
      }
    },
    {
      type: 'log',
      name: 'aCircle',
      props: ['position.x', 'position.y'],
      time: 2000
    }
]

  var container = document.getElementById('jsoneditor')
  var editor = new JSONEditor(container); 
  editor.set(demoStream)

  var recorder = new Recorder('myCanvas');

  document.getElementById('run').onclick = function(){
    console.log('running')
    recorder.addBlock(editor.get())
  }

  document.getElementById('clear').onclick = function(){
    console.log('clearBlock')
    recorder.clearBlock()
  }

  paper.view.onFrame = function(event){
    recorder.runBlocks(performance.now())
  }
</script>
</body>
</html>
